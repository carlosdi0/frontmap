---
export interface Props {
  src: string
  poster?: string
  width?: string | number
  height?: string | number
  controls?: boolean
  autoplay?: boolean
  loop?: boolean
  muted?: boolean
  preload?: 'auto' | 'metadata' | 'none'
  class?: string
  caption?: string
}

const {
  src,
  poster,
  width = '100%',
  height = 'auto',
  controls = true,
  autoplay = false,
  loop = false,
  muted = false,
  preload = 'metadata',
  class: className = '',
  caption
} = Astro.props
---

<figure class={`video-container ${className}`}>
  <video
    controls={controls}
    autoplay={autoplay}
    loop={loop}
    muted={muted}
    preload={preload}
    poster={poster}
    width={width}
    height={height}
    style={`width: ${width}; height: ${height};`}
  >
    <source src={src} type="video/mp4" />
    <source src={src.replace('.mp4', '.webm')} type="video/webm" />
    <p>Tu navegador no soporta el elemento video.</p>
  </video>
  {caption && <figcaption>{caption}</figcaption>}
</figure>

<style>
  .video-container {
    margin: 1.5rem 0;
    text-align: center;
  }

  video {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }

  figcaption {
    margin-top: 0.5rem;
    font-size: 0.875rem;
    color: var(--text-secondary);
    font-style: italic;
  }
</style>
